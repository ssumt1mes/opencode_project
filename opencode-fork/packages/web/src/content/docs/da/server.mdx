---
title: Server
description: Samhandle med opencode-server over HTTP.
---

import config from "../../../../config.mjs"
export const typesUrl = `${config.github}/blob/dev/packages/sdk/js/src/gen/types.gen.ts`

Kommandoen `opencode serve` kjører en hodeløs HTTP-server som avslører et OpenAPI-endepunkt som en opencode-klient kan bruge.

---

### Brug

```bash
opencode serve [--port <number>] [--hostname <string>] [--cors <origin>]
```

#### Alternativer

| Flagg           | Beskrivelse                                     | Standard         |
| --------------- | ----------------------------------------------- | ---------------- |
| `--port`        | Port at lytte på                                | `4096`           |
| `--hostname`    | Vertsnavn at lytte på                           | `127.0.0.1`      |
| `--mdns`        | Aktiver mDNS-oppdagelse                         | `false`          |
| `--mdns-domain` | Egendefinert domenenavn for mDNS-tjeneste       | `opencode.local` |
| `--cors`        | Ytterligere nettleseropprinnelse for at tillate | `[]`             |

`--cors` kan passeres flere ganger:

```bash
opencode serve --cors http://localhost:5173 --cors https://app.example.com
```

---

### Autentisering

Sett `OPENCODE_SERVER_PASSWORD` for at beskytte serveren med HTTP grunntilføjende autentisering. Brugernavnet er standard til `opencode`, eller sett `OPENCODE_SERVER_USERNAME` for at overstyre det. Dette gjelder både `opencode serve` og `opencode web`.

```bash
OPENCODE_SERVER_PASSWORD=your-password opencode serve
```

---

### Slik fungerer det

Når du kjører `opencode` starter den en TUI og en server. Der TUI er
klient som snakker med serveren. Serveren viser en OpenAPI 3.1-spesifikasjon
endepunkt. Dette endepunktet bruges også til at generere en [SDK](/docs/sdk).

:::tip
Brug opencode-serveren til at samhandle med opencode programmatisk.
:::

Denne arkitekturen lar opencode støtte flere klienter og lar deg samhandle med opencode programmatisk.

Du kan kjøre `opencode serve` for at starte en frittstående server. Hvis du har
opencode TUI kjører, vil `opencode serve` starte en ny server.

---

#### Koble til en eksisterende server

Når du starter TUI, tildeler den tilfeldig en port og vertsnavn. Du kan i stedet sende inn `--hostname` og `--port` [flagg](/docs/cli). Brug deretter denne til at koble til serveren.

[`/tui`](#tui) endepunktet kan bruges til at kjøre TUI gjennom serveren. Du kan for eksempel forhåndsutfylle eller kjøre en forespørsel. Dette oppsettet bruges av OpenCode [IDE](/docs/ide) plugins.

---

## Spes

Serveren publiserer en OpenAPI 3.1-spesifikasjon som kan vises på:

```
http://<hostname>:<port>/doc
```

For eksempel `http://localhost:4096/doc`. Brug spesifikasjonen til at generere klienter eller inspisere forespørsels- og svartyper. Eller se den i en Swagger-utforsker.

---

## APIer

OpenCode-serveren viser følgende APIer.

---

### Globalt

| Metode | Sti              | Beskrivelse                      | Svar                                 |
| ------ | ---------------- | -------------------------------- | ------------------------------------ |
| `GET`  | `/global/health` | Få serverhelse og versjon        | `{ healthy: true, version: string }` |
| `GET`  | `/global/event`  | Få globale hendelser (SSE strøm) | Eventstrøm                           |

---

### Prosjekt

| Metode | Sti                | Beskrivelse                 | Svar                                           |
| ------ | ------------------ | --------------------------- | ---------------------------------------------- |
| `GET`  | `/project`         | Liste over alle prosjekter  | <a href={typesUrl}><code>Prosjekt[]</code></a> |
| `GET`  | `/project/current` | Få det nåværende prosjektet | <a href={typesUrl}><code>Prosjekt</code></a>   |

---

### Bane og VCS

| Metode | Sti     | Beskrivelse                        | Svar                                        |
| ------ | ------- | ---------------------------------- | ------------------------------------------- |
| `GET`  | `/path` | Få nuværende bane                  | <a href={typesUrl}><code>Path</code></a>    |
| `GET`  | `/vcs`  | Få VCS info for nuværende prosjekt | <a href={typesUrl}><code>VcsInfo</code></a> |

---

### Forekomst

| Metode | Sti                 | Beskrivelse              | Svar      |
| ------ | ------------------- | ------------------------ | --------- |
| `POST` | `/instance/dispose` | Kast nuværende forekomst | `boolean` |

---

### Konfig

| Metode  | Sti                 | Beskrivelse                            | Svar                                                                                     |
| ------- | ------------------- | -------------------------------------- | ---------------------------------------------------------------------------------------- |
| `GET`   | `/config`           | Få konfigurasjonsinformasjon           | <a href={typesUrl}><code>Config</code></a>                                               |
| `PATCH` | `/config`           | Opdater konfigurasjon                  | <a href={typesUrl}><code>Config</code></a>                                               |
| `GET`   | `/config/providers` | Liste leverandører og standardmodeller | `{ providers: `<a href={typesUrl}>Provider[]</a>`, default: { [key: string]: string } }` |

---

### Leverandør

| Metode | Sti                              | Beskrivelse                                | Svar                                                                                |
| ------ | -------------------------------- | ------------------------------------------ | ----------------------------------------------------------------------------------- |
| `GET`  | `/provider`                      | Liste alle leverandører                    | `{ all: `<a href={typesUrl}>Provider[]</a>`, default: {...}, connected: string[] }` |
| `GET`  | `/provider/auth`                 | Få leverandørautentiseringsmetoder         | `{ [providerID: string]: `<a href={typesUrl}>ProviderAuthMethod[]</a>` }`           |
| `POST` | `/provider/{id}/oauth/authorize` | Autoriser en leverandør ved at bruge OAuth | <a href={typesUrl}><code>ProviderAuthAuthorization</code></a>                       |
| `POST` | `/provider/{id}/oauth/callback`  | Håndtere OAuth-callback for en leverandør  | `boolean`                                                                           |

---

### sessioner

| Metode   | Sti                                      | Beskrivelse                                 | Noter                                                                                 |
| -------- | ---------------------------------------- | ------------------------------------------- | ------------------------------------------------------------------------------------- |
| `GET`    | `/session`                               | Liste alle sessioner                        | Returnerer <a href={typesUrl}><code>Session[]</code></a>                              |
| `POST`   | `/session`                               | Opret en ny session                         | body: `{ parentID?, title? }`, returnerer <a href={typesUrl}><code>Session</code></a> |
| `GET`    | `/session/status`                        | Få sessionstatus for alle sessioner         | Returnerer `{ [sessionID: string]: `<a href={typesUrl}>SessionStatus</a>` }`          |
| `GET`    | `/session/:id`                           | Få sessiondetaljer                          | Returnerer <a href={typesUrl}><code>Session</code></a>                                |
| `DELETE` | `/session/:id`                           | Slett en session og alle dens data          | Returnerer `boolean`                                                                  |
| `PATCH`  | `/session/:id`                           | Opdater sessionegenskaper                   | body: `{ title? }`, returnerer <a href={typesUrl}><code>Session</code></a>            |
| `GET`    | `/session/:id/children`                  | Få en sessions barnesessioner               | Returnerer <a href={typesUrl}><code>Session[]</code></a>                              |
| `GET`    | `/session/:id/todo`                      | Få to-doslisten for en session              | Returnerer <a href={typesUrl}><code>Todo[]</code></a>                                 |
| `POST`   | `/session/:id/init`                      | Analyser appen og lag `AGENTS.md`           | body: `{ messageID, providerID, modelID }`, returnerer `boolean`                      |
| `POST`   | `/session/:id/fork`                      | Fork en eksisterende session ved en melding | body: `{ messageID? }`, returnerer <a href={typesUrl}><code>Session</code></a>        |
| `POST`   | `/session/:id/abort`                     | Avbryt en løpesession                       | Returnerer `boolean`                                                                  |
| `POST`   | `/session/:id/share`                     | Del en session                              | Returnerer <a href={typesUrl}><code>Session</code></a>                                |
| `DELETE` | `/session/:id/share`                     | Slutt at dele en session                    | Returnerer <a href={typesUrl}><code>Session</code></a>                                |
| `GET`    | `/session/:id/diff`                      | Få diff for denne sessionen                 | spørring: `messageID?`, returnerer <a href={typesUrl}><code>FileDiff[]</code></a>     |
| `POST`   | `/session/:id/summarize`                 | Oppsummer sessionen                         | body: `{ providerID, modelID }`, returnerer `boolean`                                 |
| `POST`   | `/session/:id/revert`                    | Tilbakestill en melding                     | body: `{ messageID, partID? }`, returnerer `boolean`                                  |
| `POST`   | `/session/:id/unrevert`                  | Gjenopret alle nulstillete meldinger        | Returnerer `boolean`                                                                  |
| `POST`   | `/session/:id/permissions/:permissionID` | Svar på en tillatelsesforespørsel           | body: `{ response, remember? }`, returnerer `boolean`                                 |

---

### Meldinger

| Metode | Sti                               | Beskrivelse                            | Noter                                                                                                                                                                    |
| ------ | --------------------------------- | -------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `GET`  | `/session/:id/message`            | Liste meldinger i en session           | spørring: `limit?`, returnerer `{ info: `<a href={typesUrl}>Message</a>`, parts: `<a href={typesUrl}>Part[]</a>`}[]`                                                     |
| `POST` | `/session/:id/message`            | Send en melding og vent på svar        | body: `{ messageID?, model?, agent?, noReply?, system?, tools?, parts }`, returnerer `{ info: `<a href={typesUrl}>Message</a>`, parts: `<a href={typesUrl}>Part[]</a>`}` |
| `GET`  | `/session/:id/message/:messageID` | Få meldingsdetaljer                    | Returnerer `{ info: `<a href={typesUrl}>Message</a>`, parts: `<a href={typesUrl}>Part[]</a>`}`                                                                           |
| `POST` | `/session/:id/prompt_async`       | Send en melding asynkront (ingen vent) | body: samme som `/session/:id/message`, returnerer `204 No Content`                                                                                                      |
| `POST` | `/session/:id/command`            | Utfør en skråstrek-kommando            | body: `{ messageID?, agent?, model?, command, arguments }`, returnerer `{ info: `<a href={typesUrl}>Message</a>`, parts: `<a href={typesUrl}>Part[]</a>`}`               |
| `POST` | `/session/:id/shell`              | Kjør en shell-kommando                 | body: `{ agent, model?, command }`, returnerer `{ info: `<a href={typesUrl}>Message</a>`, parts: `<a href={typesUrl}>Part[]</a>`}`                                       |

---

### Kommandoer

| Metode | Sti        | Beskrivelse           | Svar                                           |
| ------ | ---------- | --------------------- | ---------------------------------------------- |
| `GET`  | `/command` | Liste alle kommandoer | <a href={typesUrl}><code>Kommando[]</code></a> |

---

### Filer

| Metode | Sti                      | Beskrivelse                        | Svar                                                                                       |
| ------ | ------------------------ | ---------------------------------- | ------------------------------------------------------------------------------------------ |
| `GET`  | `/find?pattern=<pat>`    | Søk etter tekst i filer            | En rekke matchobjekter med `path`, `lines`, `line_number`, `absolute_offset`, `submatches` |
| `GET`  | `/find/file?query=<q>`   | Finn filer og kataloger etter navn | `string[]` (baner)                                                                         |
| `GET`  | `/find/symbol?query=<q>` | Finn arbeidsområdesymboler         | <a href={typesUrl}><code>Symbol[]</code></a>                                               |
| `GET`  | `/file?path=<path>`      | Liste filer og kataloger           | <a href={typesUrl}><code>FilNode[]</code></a>                                              |
| `GET`  | `/file/content?path=<p>` | Les en fil                         | <a href={typesUrl}><code>Filinnhold</code></a>                                             |
| `GET`  | `/file/status`           | Få status for sporede filer        | <a href={typesUrl}><code>Fil[]</code></a>                                                  |

#### `/find/file` spørringsparametere

- `query` (obligatorisk) - søkestreng (uklar samsvar)
- `type` (valgfritt) - begrense resultatene til `"file"` eller `"directory"`
- `directory` (valgfritt) — overstyr prosjektroten for søket
- `limit` (valgfritt) - maks. resultater (1–200)
- `dirs` (valgfritt) - eldre flagg (`"false"` returnerer kun filer)

---

### Verktøy (eksperimentelt)

| Metode | Sti                                         | Beskrivelse                                  | Svar                                         |
| ------ | ------------------------------------------- | -------------------------------------------- | -------------------------------------------- |
| `GET`  | `/experimental/tool/ids`                    | Vis alle verktøy-ID-er                       | <a href={typesUrl}><code>ToolIDs</code></a>  |
| `GET`  | `/experimental/tool?provider=<p>&model=<m>` | List verktøy med JSON-skjemaer for en modell | <a href={typesUrl}><code>ToolList</code></a> |

---

### LSP, formattere og MCP

| Metode | Sti          | Beskrivelse                  | Svar                                                     |
| ------ | ------------ | ---------------------------- | -------------------------------------------------------- |
| `GET`  | `/lsp`       | Få LSP serverstatus          | <a href={typesUrl}><code>LSPStatus[]</code></a>          |
| `GET`  | `/formatter` | Få formateringsstatus        | <a href={typesUrl}><code>FormatterStatus[]</code></a>    |
| `GET`  | `/mcp`       | Få MCP serverstatus          | `{ [name: string]: `<a href={typesUrl}>MCPStatus</a>` }` |
| `POST` | `/mcp`       | Legg til MCP server dynamisk | body: `{ name, config }`, returnerer MCP statusobjekt    |

---

### Agenter

| Metode | Sti      | Beskrivelse                     | Svar                                        |
| ------ | -------- | ------------------------------- | ------------------------------------------- |
| `GET`  | `/agent` | Liste alle tilgængelige agenter | <a href={typesUrl}><code>Agent[]</code></a> |

---

### Logging

| Metode | Sti    | Beskrivelse                                                           | Svar      |
| ------ | ------ | --------------------------------------------------------------------- | --------- |
| `POST` | `/log` | Skriv loggoppføring. Brødtekst: `{ service, level, message, extra? }` | `boolean` |

---

### TUI

| Metode | Sti                     | Beskrivelse                                 | Svar                       |
| ------ | ----------------------- | ------------------------------------------- | -------------------------- |
| `POST` | `/tui/append-prompt`    | Legg til tekst i ledeteksten                | `boolean`                  |
| `POST` | `/tui/open-help`        | Åpne hjelpedialogen                         | `boolean`                  |
| `POST` | `/tui/open-sessions`    | Åpne sessionvelgeren                        | `boolean`                  |
| `POST` | `/tui/open-themes`      | Åpne temavelgeren                           | `boolean`                  |
| `POST` | `/tui/open-models`      | Åpne modellvelgeren                         | `boolean`                  |
| `POST` | `/tui/submit-prompt`    | Send inn nuværende ledetekst                | `boolean`                  |
| `POST` | `/tui/clear-prompt`     | Fjern ledeteksten                           | `boolean`                  |
| `POST` | `/tui/execute-command`  | Utfør en kommando (`{ command }`)           | `boolean`                  |
| `POST` | `/tui/show-toast`       | Vis toast (`{ title?, message, variant }`)  | `boolean`                  |
| `GET`  | `/tui/control/next`     | Vent på neste kontrollforespørsel           | Kontrollforespørselsobjekt |
| `POST` | `/tui/control/response` | Svar på en kontrollforespørsel (`{ body }`) | `boolean`                  |

---

### Auth

| Metode | Sti         | Beskrivelse                                                                 | Svar      |
| ------ | ----------- | --------------------------------------------------------------------------- | --------- |
| `PUT`  | `/auth/:id` | Angi autentiseringslegitimasjon. Brødtekst må samsvare med leverandørskjema | `boolean` |

---

### Hendelser

| Metode | Sti      | Beskrivelse                                                                                        | Svar                           |
| ------ | -------- | -------------------------------------------------------------------------------------------------- | ------------------------------ |
| `GET`  | `/event` | Server-sendte hendelsesstrøm. Første arrangement er `server.connected`, deretter bussarrangementer | Server-sendte hendelser stream |

---

### Dokumenter

| Metode | Sti    | Beskrivelse               | Svar                                |
| ------ | ------ | ------------------------- | ----------------------------------- |
| `GET`  | `/doc` | OpenAPI 3.1-spesifikasjon | HTML side med OpenAPI-spesifikasjon |
